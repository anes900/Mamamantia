<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAMA MANTIA - SISTEM</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #2D1409; color: #fff; }
        .container { padding: 20px; max-width: 500px; margin: auto; }
        .card { background: #fff; color: #2D1409; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); margin-top: 20px; }
        .header { background: #3d1f0a; padding: 15px; text-align: center; border-bottom: 2px solid #FFB74D; color: #FFB74D; font-weight: bold; }
        .btn { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; font-size: 16px; }
        .btn-main { background: #FFB74D; color: #2D1409; }
        .input-field { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        .item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; align-items: center; }
        .status-msg { text-align: center; font-size: 14px; margin-top: 10px; color: #FFB74D; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [userRole, setUserRole] = useState(null);
            const [items, setItems] = useState([]);
            const [newItem, setNewItem] = useState("");

            // Uƒçitavanje iz lokalne memorije telefona (radi odmah, bez interneta)
            useEffect(() => {
                const saved = localStorage.getItem("mantia_data");
                if (saved) setItems(JSON.parse(saved));
            }, []);

            const saveAndRefresh = (newList) => {
                setItems(newList);
                localStorage.setItem("mantia_data", JSON.stringify(newList));
            };

            const dodajArtikal = () => {
                if (!newItem) return;
                const newList = [...items, { id: Date.now(), naziv: newItem, kolicina: 0 }];
                saveAndRefresh(newList);
                setNewItem("");
            };

            const promjenaKolicine = (id, n) => {
                const newList = items.map(i => i.id === id ? { ...i, kolicina: i.kolicina + n } : i);
                saveAndRefresh(newList);
            };

            if (!userRole) {
                return (
                    <div className="container">
                        <div className="card">
                            <h2 style={{textAlign: 'center'}}>MAMA MANTIA</h2>
                            <p style={{textAlign: 'center'}}>Izaberite ulogu:</p>
                            <button className="btn btn-main" onClick={() => setUserRole("Direktor")}>üëî DIREKTOR</button>
                            <button className="btn btn-main" onClick={() => setUserRole("Prodavac")}>üè™ PRODAVAC</button>
                        </div>
                    </div>
                );
            }

            return (
                <div>
                    <div className="header">
                        PRIJAVLJEN: {userRole} | <span onClick={() => setUserRole(null)} style={{textDecoration: 'underline', cursor: 'pointer'}}>Odjavi se</span>
                    </div>
                    <div className="container">
                        <div className="card">
                            <h3>Unos artikala</h3>
                            <input 
                                className="input-field" 
                                value={newItem} 
                                onChange={(e) => setNewItem(e.target.value)} 
                                placeholder="Naziv mantije/pite..." 
                            />
                            <button className="btn btn-main" onClick={dodajArtikal}>+ DODAJ U LISTU</button>
                        </div>

                        <div className="card">
                            <h3>Trenutne zalihe</h3>
                            {items.length === 0 ? <p>Nema artikala u listi.</p> : items.map(item => (
                                <div className="item" key={item.id}>
                                    <span>{item.naziv}</span>
                                    <div>
                                        <button onClick={() => promjenaKolicine(item.id, -1)} style={{padding: '5px 10px'}}>-</button>
                                        <span style={{margin: '0 10px', fontWeight: 'bold'}}>{item.kolicina}</span>
                                        <button onClick={() => promjenaKolicine(item.id, 1)} style={{padding: '5px 10px'}}>+</button>
                                    </div>
                                </div>
                            ))}
                        </div>
                        <p className="status-msg">Sistem je spreman za rad ‚úÖ</p>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
